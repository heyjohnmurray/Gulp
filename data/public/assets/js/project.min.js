// example of page transition on form submit :: http://api.jquerymobile.com/pagecontainer/#method-change
$(function(){function t(){var e=u("choices"),t=u("userID");i();$.post("/vote/",{PollData:e,UserID:t},function(e){$("#score").html(e.pollResult)}).fail(function(){$("#score").html("0")}).always(function(){$(":mobile-pagecontainer").pagecontainer("change","#slide49",{transition:"slide"})})}function n(e){document.cookie="currentSlide="+e+";"}function r(e){document.cookie="userID="+e+";"}function i(){document.cookie="currentSlide=; expires=Thu, 01-Jan-1970 00:00:01 GMT;";document.cookie="userID=; expires=Thu, 01-Jan-1970 00:00:01 GMT;";document.cookie="choices=; expires=Thu, 01-Jan-1970 00:00:01 GMT;"}function s(){var e=u("userID");if(e){var t=u("currentSlide");t&&a(t)}}function o(e){var t=u("choices"),n={};t&&(n=JSON.parse(t));var r=e.toString().split(".");n[r[0]]=r[1];document.cookie="choices="+JSON.stringify(n)+";"}function u(e){var t=e+"=",n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1);if(i.indexOf(t)!=-1)return i.substring(t.length,i.length)}return""}function a(e){var t=!1,r=!1;$(":mobile-pagecontainer").pagecontainer("change",e,{transition:"slide",changeHash:!1});var i=$(e).attr("class");if(i&&i.indexOf("js-full-first")!==-1)var t=$(e+" + div").attr("id"),r=$("#"+t+" + div").attr("id");else if(i&&i.indexOf("js-full-second")!==-1)var t=$(e+" + div").attr("id");r?setTimeout(function(){$(":mobile-pagecontainer").pagecontainer("change","#"+t,{transition:"slide"});n("#"+t);setTimeout(function(){$(":mobile-pagecontainer").pagecontainer("change","#"+r,{transition:"slide"});n("#"+r)},3e3)},3e3):t&&setTimeout(function(){$(":mobile-pagecontainer").pagecontainer("change","#"+t,{transition:"slide"});n("#"+t)},3e3)}s();$(".js-signup-form").submit(function(e){$.post("/login/",$(".js-signup-form").serialize(),function(e){if(e.userID){r(e.userID);n("#slide1");$(":mobile-pagecontainer").pagecontainer("change","#slide1",{transition:"slide",changeHash:!1})}}).fail(function(e){var t=$.parseJSON(e.responseText);console.log("Error: "+t.message);if(t.error&&t.detail&&t.error=="Validation Error"){for(var n in t.detail)$('input[name="'+n+'"]').addClass("error");$(".invalid-inputs").html("Please fix the highlighted fields")}});e.preventDefault()});$(".leaderboard").on("tap",function(e){$.mobile.navigate(this.attr("href"));e.preventDefault()});$(".js-start-auto-slides").on("tap",function(e){n($(e.target).attr("href"));var t=$(e.target).data("next-slide"),r=$(e.target).data("second-slide");setTimeout(function(){$(":mobile-pagecontainer").pagecontainer("change",t,{transition:"slide"});n(t);setTimeout(function(){$(":mobile-pagecontainer").pagecontainer("change",r,{transition:"slide"});n(r)},3e3)},3e3)});$(".js-start-video-slide").on("tap",function(e){var t=$(e.target).data("next-slide");$("#test").play();$("video").bind("ended",function(){alert("I'm done!")})});$(window).on("orientationchange",function(e){e.orientation==="portrait"&&alert("please view this app in landscape mode")});var e=null;$(".js-vote-choice").on("tap",function(e){var r=$(e.target).data("choice"),i=$(e.target).data("next-slide");n(i);if(r!=null){o(r);$(e.target).addClass("answer-confirm");$(e.target).parent().parent().siblings().addClass("is-faded")}e.preventDefault();i!=="#slide49"?$(":mobile-pagecontainer").pagecontainer("change",i,{transition:"slide"}):t()})});