function onError(e,t,n,r){if(!e||!e.message)e.message="An unknown error as occurred";e.name&&e.name=="Validation Error"?n.status(400).json({error:e.name,message:e.message,detail:e.errors}):n.status(500).json({error:e.name,message:e.message,detail:e.errors})}var express=require("express"),app=module.exports=express(),bodyParser=require("body-parser"),expressValidator=require("express-validator");app.use(bodyParser.urlencoded({extended:!1}));app.use(bodyParser.json());app.use(bodyParser.json({type:"application/vnd.api+json"}));app.use(expressValidator());app.use(express.static(__dirname+"/public"));var server=app.listen(3e3,function(){console.log("Listening on port %d",server.address().port)});io=require("socket.io").listen(server);require("./app/routes")(app);app.use(onError);